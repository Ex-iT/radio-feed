<!DOCTYPE html>
<html lang="nl">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="theme-color" content="#000000">
	<title>Live stream verschillende radiostations | IsHetAlDonderdag.nl</title>
	<meta name="description" content="Live stream verschillende radiostations">
	<meta name="keywords" content="Radiostations, live radio, live stream">
	<link rel="manifest" href="manifest.json">
	<link rel="shortcut icon" href="favicon.ico">
	<title>Radiofeed</title>
</head>
<body>
	<h2>Now playing: <span id="title"></span></h2>

	<!-- <button id="btnPlay" disabled>Play</button> -->
	<audio id="audio" controls preload="none" controlsList="nodownload"></audio>

	<p>Playlist</p>
	<ol id="playlist">
	</ol>

	<script>
		(function () {
			const playlist = [{
				label: 'SkyRadio - Lounge',
				src: 'https://19013.live.streamtheworld.com/SRGSTR07AAC.aac'
			},
			{
				label: 'SLAM! - Non-stop',
				src: 'https://20103.live.streamtheworld.com/WEB10_MP3.mp3'
			}];

			const audioEl = document.getElementById('audio');
			const playlistEl = document.getElementById('playlist');
			const titleEl = document.getElementById('title');
			const btnPlay = document.getElementById('btnPlay');

			setPlaylist();
			handleAudioEvents();

			function handleAudioEvents() {
				// audioEl.addEventListener('playing', event => {
				// 	console.log(event);
				// 	btnPlay.innerText = 'Pause';
				// 	btnPlay.disabled = false;
				// });

				audioEl.addEventListener('pause', () => {
					// Actually stop the stream from downloading
					const currentSrc = audioEl.src;
					audioEl.src = '';
					audioEl.src = currentSrc;
				});
			}

			function setPlaylist() {
				if (playlist) {
					const docFragment = document.createDocumentFragment();
					const items = playlist.forEach(item => {
						const listItem = document.createElement('li');
						const listBtn = document.createElement('button');
						listBtn.type = 'button';
						listBtn.innerText = item.label;
						listBtn.dataset.label = item.label;
						listBtn.dataset.src = item.src;

						listBtn.addEventListener('click', event => {
							const btn = event.target;
							audioEl.src = btn.dataset.src;
							titleEl.innerText = btn.dataset.label;
							audioEl.play();
						}, false);

						listItem.appendChild(listBtn);
						docFragment.appendChild(listItem);
					});

					playlistEl.innerHTML = '';
					playlistEl.appendChild(docFragment);
				}
			}
		})();
	</script>
</body>
</html>
